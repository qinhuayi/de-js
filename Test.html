<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>Test</title>
    <style>
        body { font-size: 12px; }
        body, h1 { background-color: #eee; }
        .doc, h1, #testList { width: 920px; margin: 1px auto; }
        .doc, #testList { background-color: #fff; padding: 0.5em; margin:0.6em auto; }
        #divOut { height: 2em; width:100%; }
        #iframe1 { height: 10em; min-width:600px;width:70%; }
        table { border-width: 1px; border-collapse: collapse; border-style: solid; border-color: #999; margin: 0.5em; }
        tr, td { padding: 0.2em; border-width: 1px; border-style: solid; border-color: #999; }
        li { list-style-position: inside; list-style-type: decimal; line-height:1.5em;}
        span { margin: 1px; padding:0.1em; }
        b { color: #ff6a00; }
        span, a, b { margin:0.1em; }
        sup { color:red; font-size:9px;display:inline-block; }
        .blue { color: blue; }
        .red {color:red; }
        .green {color:green;}
        li span.blue { width:22em; display:inline-block; text-align:left; }
    </style>
    <link rel="stylesheet" href="./styles/fake.css" />
    <script src="./de1.7/de.js?v"></script>
    <!--<script src="Test.html.js?v1"></script>-->
    <script>
        function getFunctonName(span) {
            var name = span.innerHTML,
                index = name.indexOf('(');
            return index > 0 ? name.substring(0, index) : name;
        }

        var Testor = {
            "$e": function (idoc, divOut) {
                var rs0 = typeof $e('iframe1') == 'object' && $e('iframe1') && $e('iframe1').tagName == 'IFRAME';
                var rs1 = $e(document.body) && $e(document.body).tagName == 'BODY';
                var p = $e('p1', idoc);
                var rs2 = typeof p == 'object' && p && p.tagName == 'P';

                var rs3 = typeof $e('*group1') == 'object' && $e('*group1') && $e('*group1').length == 3;
                var rs4 = typeof $e('*group2', idoc) == 'object' && $e('*group2', idoc) && $e('*group2', idoc).length == 4;

                var sp0 = $e("<span class='red'>");
                var rs5 = typeof sp0 == 'object' && sp0 && sp0.tagName == 'SPAN';
                rs5 && divOut.appendChild(sp0);
                rs5 && (sp0.innerHTML = '$e-sp0');
                var sp1 = $e("<span class='red'>", idoc);
                var divOut2 = idoc && idoc.getElementById('divOut');
                var rs6 = divOut2 && typeof sp1 == 'object' && sp1 && sp1.tagName == 'SPAN';
                divOut2 && divOut2.appendChild(sp1);
                rs6 && (sp1.innerHTML = '$e-sp1');

                return [rs0, rs1, rs2, rs3, rs4, rs5, rs6];
            },
            "$t": function (idoc, divOut) {
                var arr = null;
                var rs0 = typeof $t('form') == 'object' && (arr = $t('form')) && arr.length == 1;
                rs0 = rs0 && typeof $tags('form') == 'object' && (arr = $tags('form')) && arr.length == 1;
                var rs1 = rs0 && (arr = $t('h1,h2')) && arr.length == 3;
                var rs2 = rs0 && (arr = $t('div.doc')) && arr.length == 1 && arr[0].className == 'doc';
                var rs3 = rs0 && (arr = $t('a[id]')) && arr.length == 3 && arr[0].id == 'a1';
                var rs4 = rs0 && (arr = $t('a[id=a1]')) && arr.length == 1 && arr[0].id == 'a1';
                rs4 = rs4 && (arr = $t('a[id==a1]')) && arr.length == 1 && arr[0].id == 'a1';
                var rs5 = rs0 && (arr = $t('a[class*=ink]')) && arr.length == 3 && arr[0].className.indexOf('ink') >= 0;
                var rs6 = rs0 && (arr = $t('a[id~=0]')) && arr.length == 2 && arr[0].id == 'a1';
                var rs7 = rs0 && (arr = $t('a[id$=0]')) && arr.length == 1 && arr[0].id == 'a0';
                var rs8 = rs0 && (arr = $t('a[id^=a]')) && arr.length == 3 && arr[2].id == 'a2';
                var rs9 = rs0 && (arr = $t('a[id!=a1]')) && arr.length == 2 && arr[0].id == 'a2';

                var str0 = "\\~!@#$%^&*()_+`-=[中文]\{}|;':,./< >?",
                    str1 = '\\~!@#$%^&*()_+`-=[中文]\{}|;":,./< >?';
                var rs10 = rs0 && (arr = $t('img[_data]')) && arr.length == 2 && arr[0].getAttribute('id') == 'img0';
                var rs11 = rs0 && (arr = $t('img[_data="' + str0 + '"]')) && arr.length == 1 && arr[0].getAttribute('id') == 'img0';
                rs11 = rs11 && (arr = $t("img[_data='" + str1 + "']")) && arr.length == 1 && arr[0].getAttribute('id') == 'img1';
                var rs12 = rs0 && (arr = $t('img[_data*="]')) && arr.length == 1 && arr[0].getAttribute('id') == 'img1';
                rs12 = rs12 && (arr = $t("img[_data*=']")) && arr.length == 1 && arr[0].getAttribute('id') == 'img0';
                var str2 = "'[\,]'",
                    str3 = '"[\,]"';
                var rs13 = rs0 && (arr = $t('img[src~="' + str2 + '"]')) && arr.length == 1 && arr[0].id == 'img1';
                rs13 = rs13 && (arr = $t("img[src~='" + str3 + "']")) && arr.length == 1 && arr[0].id == 'img0';
                var rs14 = rs0 && (arr = $t("a[href$='detail']")) && arr.length == 1 && arr[0].id == 'a0';
                var rs15 = rs0 && (arr = $t('a[href^="./X/页/a.html"]')) && arr.length == 2 && arr[0].id == 'a0' && arr[1].id == 'a1';
                var rs16 = rs0 && (arr = $t('img[_data!=' + str2 + ']')) && arr.length == 1 && arr[0].id == 'img0';

                var rs17 = rs0 && (arr = $t('a.link1[id*=a, href*="/页/a.html?id=1&mode=more"]')) && arr.length == 1 && arr[0].getAttribute('id') == 'a1';
                var rs18 = rs0 && (arr = $t('div.doc\p\a[href*="/a.html"]')) && arr.length == 2 && arr[0].id == 'a0' && arr[1].id == 'a1';
                rs18 = rs0 && (arr = $t('div.doc/p/a[href*="/a.html"]')) && arr.length == 2 && arr[0].id == 'a0' && arr[1].id == 'a1';
                var rs19 = rs0 && (arr = $t('div.doc//a[href*="/a.html"]')) && arr.length == 2 && arr[0].id == 'a0' && arr[1].id == 'a1';
                rs19 = rs0 && (arr = $t('div.doc\\a[href*="/a.html"]')) && arr.length == 2 && arr[0].id == 'a0' && arr[1].id == 'a1';
                var rs20 = rs0 && (arr = $t('p.poem/a[id^=a, href*="./X/页/"], div.doc//img[id^="img", src*="/images/"]')) && arr.length == 4 && arr[1].id == 'a1' && arr[3].id == 'img1';
                rs20 = rs20 && (arr = $t('p.poem/a[id^="a", href*="./X/页/"], body//img[id^="img", src*="' + str2 + '"]')) && arr.length == 3 && arr[1].id == 'a1' && arr[2].id == 'img0';
                return [rs0, rs1, rs2, rs3, rs4, rs5, rs6, rs7, rs8, rs9, rs10, rs11, rs12, rs13, rs14, rs15, rs16, rs17, rs18, rs19, rs20];
            }
        }

        function btnTest_click(evt) {
            var msg = evt.srcElement.nextSibling,
                divOut = document.getElementById('divOut'),
                iframe = document.getElementById('iframe1'),
                frm1 = frames['frame1'] || iframe.contentWindow,
                idoc = frm1 ? frm1.document : null,
                name = getFunctonName(evt.srcElement.previousSibling),
                arr = typeof Testor[name] == 'function' ? Testor[name](idoc, divOut) : [];
            for (var i = 0; i < arr.length; i++) {
                msg.innerHTML += arr[i] ? "<span class='green'>✓</span>" : "<span class='red'>✕</span>";
            }
        }

        function bind(e, name, method) {
            if (e.attachEvent) {
                e.attachEvent('on' + name, method);
            } else if (e.addEventListener) {
                e.addEventListener(name, method, false);
            } else if (e && e !== undefined) {
                e[name] = method;
            }
        }

        function btnTestAll_click(evt) {
            ////:
        }

        document.ready(function () {
            var btns = document.getElementsByTagName('BUTTON');
            for (var i = 0; i < btns.length; i++) {
                bind(btns[i], 'click', btnTest_click);
            }
            bind(document.getElementById('btnTestAll'), 'click', btnTestAll_click);
            document.getElementById('h2').innerHTML += ' ok!';
        });
    </script>
</head>
<body>
    <h1 id="h1">Test de1.7</h1>
    <div class="doc">
        <h2>HTML脚本区</h2>
        <p class="poem">诗一首：<b>一</b>去<b>二</b><b>三</b>里，<b>四</b><b>五</b>户人家，<b>六</b><b>七</b>颗桃树，<b>八</b><b>九</b><b>十</b>枝花。
            <a id="a0" class="link1" href="./X/页/a.html?id=1&mode=detail">详细..</a><a id="a1" class="link1" href="./X/页/a.html?id=1&mode=more">更多..</a><br />
        </p>
        <p>
            图两张:<img id="img0" alt="fake image 0" _data="\\~!@#$%^&*()_+`-=[中文]\{}|;':,./< >?" src="./images/小图/img0.asp?arr=['a','[\,]','c']" />
            <img id="img1" alt="fake image 1" _data='\\~!@#$%^&*()_+`-=[中文]\{}|;":,./< >?' src='./images/小图/img1.asp?arr=["e","[\,]","g"]' />
            <a id="a2" class="link1" href="./X/页/b.html?id=1&mode=more">更多..</a>
        </p>
        <form action="#" name="form1">
            <table>
                <caption>表格</caption>
                <tbody>
                    <tr>
                        <td>职业</td>
                        <td>
                            <select id="sel">
                                <option value="A">A职业</option>
                                <option value="B">B职业</option>
                                <option value="C">C职业</option>
                            </select></td>
                    </tr>
                    <tr>
                        <td>颜色</td>
                        <td>
                            <input id="rb0" name="group1" type="radio" value="red" checked /><label for="rb0">red</label>
                            <input id="rb1" name="group1" type="radio" value="green" /><label for="rb1">green</label>
                            <input id="rb2" name="group1" type="radio" value="blue" /><label for="rb2">blue</label></td>
                    </tr>
                </tbody>
            </table>
        </form>
        <iframe id="iframe1" name="frame1" src="./iframe.html?v1"></iframe>
        <div id="divOut"></div>
    </div>
    <div id="testList">
        <h2 id="h2">测试功能区</h2>
        <h3>基本函数</h3>
        <ul>
            <li><span class="blue">$e(e, doc)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$t(specifies) $tags(specifies)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$$.ajax(conf)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$$.format(format, arg0, arg1, ..., argn)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$$.htmlEncode(str, mode)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$$.htmlDecode(str, mode)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">$$.url2Object(url)</span><button type="button">Test</button><span class=msg></span></li>
        </ul>
        <h3>文档元素扩展方法与属性</h3>
        <ul>
            <li><span class="blue">document.path</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">document.ready(fn)</span><button type="button">Test</button><span class=msg></span></li>
        </ul>
        <h3>de文档元素(数组)方法与属性</h3>
        <ul>
            <li><span class="blue">addClass(name)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">append(node)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">attr(name, value)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">bind(name, fn)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">css(name, value)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">hide()</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">html(str)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">insert(node, n)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">parent(specifies)</span><sup>1.7+</sup><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">pos()</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">removeAttr(name)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">removeClass(name)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">show()</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">tags(specifies)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">text(str)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">unbind(name, fn)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">val(value)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">value</span><button type="button">Test</button><span class=msg></span></li>
        </ul>
        <h3>类型扩展方法</h3>
        <ul>
            <li><span class="blue">Array.forEach(fn)</span><sup>1.7+</sup><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Array.each(fn)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Array.exists(e)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Array.indexof(e)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Date.add(part, n)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Date.diff(part, date)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Date.fromString(str, format)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Date.toObject()</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">Date.toString(format)</span><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">String.format(...)</span><sup>1.7+</sup><button type="button">Test</button><span class=msg></span></li>
            <li><span class="blue">String.trim()</span><button type="button">Test</button><span class=msg></span></li>
        </ul>
        <input id='btnTestAll' type="button" onclick="btnTestAll_click(event)" value="btnTestAll" />
    </div>
</body>
</html>
